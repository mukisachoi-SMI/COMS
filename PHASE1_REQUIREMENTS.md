# 교회 헌금관리시스템 Phase 1 개발 요구사항 정의서

## 📋 문서 개요

| 항목 | 내용 |
|------|------|
| **프로젝트명** | Church Offering Management System (COMS) |
| **버전** | Phase 1.0 |
| **문서 유형** | 개발 요구사항 정의서 |
| **작성일** | 2025년 1월 |
| **대상 독자** | 개발팀, 프로젝트 관리자, 교회 관리자 |

## 🎯 프로젝트 목표

### 1.1 비즈니스 목표
- 교회의 헌금 관리 업무를 완전 디지털화
- 헌금 처리 시간 50% 단축 및 정확도 99% 이상 달성
- 투명하고 체계적인 헌금 관리 시스템 구축
- 실시간 통계 및 보고서를 통한 의사결정 지원

### 1.2 기술적 목표
- 현대적이고 확장 가능한 웹 애플리케이션 개발
- 모바일 우선 반응형 디자인 구현
- 강력한 보안 및 데이터 무결성 보장
- 직관적이고 사용하기 쉬운 사용자 인터페이스 제공

## 🏗️ 시스템 아키텍처

### 2.1 기술 스택

#### Frontend
- **Framework**: React 18.x + TypeScript
- **UI Library**: Tailwind CSS 3.x
- **State Management**: React Hooks
- **Build Tool**: Create React App
- **Icons**: Lucide React

#### Backend & Database
- **Backend Service**: Supabase
- **Database**: PostgreSQL
- **Authentication**: Supabase Auth
- **Real-time**: Supabase Realtime
- **Storage**: Supabase Storage

#### 배포 및 호스팅
- **Frontend Hosting**: Netlify
- **Domain**: 커스텀 도메인 지원
- **SSL**: 자동 HTTPS 적용

### 2.2 보안 아키텍처
- **Row Level Security (RLS)**: 교회별 데이터 격리
- **JWT 토큰**: 사용자 인증 및 세션 관리
- **API 보안**: 모든 API 요청에 대한 인증 검증
- **데이터 암호화**: 민감 정보 암호화 저장

## 📊 데이터베이스 설계

### 3.1 핵심 테이블 구조

#### churches (교회 정보)
```sql
CREATE TABLE churches (
  church_id VARCHAR(20) PRIMARY KEY,
  church_name VARCHAR(100) NOT NULL,
  address TEXT,
  phone VARCHAR(20),
  email VARCHAR(100),
  logo_url TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

#### members (교인 관리)
```sql
CREATE TABLE members (
  member_id VARCHAR(20) PRIMARY KEY,
  church_id VARCHAR(20) REFERENCES churches(church_id),
  member_name VARCHAR(50) NOT NULL,
  phone VARCHAR(20),
  email VARCHAR(100),
  address TEXT,
  birth_date DATE,
  position_id VARCHAR(20),
  status VARCHAR(10) DEFAULT 'active',
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

#### donations (헌금 내역)
```sql
CREATE TABLE donations (
  donation_id VARCHAR(30) PRIMARY KEY,
  church_id VARCHAR(20) REFERENCES churches(church_id),
  member_id VARCHAR(20) REFERENCES members(member_id),
  donor_name VARCHAR(50),
  donation_type_id VARCHAR(20) NOT NULL,
  amount INTEGER NOT NULL,
  donation_date DATE NOT NULL,
  payment_method VARCHAR(10) NOT NULL,
  notes TEXT,
  status VARCHAR(10) DEFAULT 'active',
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

#### donation_types (헌금 종류)
```sql
CREATE TABLE donation_types (
  type_id VARCHAR(20) PRIMARY KEY,
  church_id VARCHAR(20) REFERENCES churches(church_id),
  type_name VARCHAR(50) NOT NULL,
  is_active BOOLEAN DEFAULT true,
  sort_order INTEGER DEFAULT 0,
  created_at TIMESTAMP DEFAULT NOW()
);
```

### 3.2 보안 정책 (RLS)
- 모든 테이블에 교회별 데이터 접근 제한
- 사용자는 자신이 속한 교회의 데이터만 접근 가능
- 관리자 권한에 따른 세분화된 접근 제어

## 🚀 핵심 기능 요구사항

### 4.1 인증 및 사용자 관리

#### 4.1.1 로그인/로그아웃
- **기능**: 교회별 독립적인 로그인 시스템
- **구현**: Supabase Auth 기반 JWT 토큰 인증
- **보안**: 세션 만료 관리 및 자동 로그아웃
- **UX**: 로그인 상태 유지 및 자동 리디렉션

#### 4.1.2 세션 관리
- **교회 컨텍스트**: 로그인 시 교회 정보 자동 로드
- **권한 관리**: 사용자별 접근 권한 제어
- **데이터 격리**: 교회별 완전한 데이터 분리

### 4.2 교인 관리 시스템

#### 4.2.1 교인 등록/수정/삭제
- **등록**: 신규 교인 정보 입력 및 저장
- **수정**: 기존 교인 정보 업데이트
- **삭제**: 소프트 딜리트 방식의 안전한 삭제
- **검증**: 필수 정보 및 데이터 형식 검증

#### 4.2.2 교인 검색 및 필터링
- **실시간 검색**: 이름 기반 즉시 검색
- **고급 필터**: 직분, 상태별 필터링
- **정렬**: 이름, 등록일, 직분별 정렬
- **페이지네이션**: 대용량 데이터 효율적 로딩

#### 4.2.3 직분 관리
- **직분 설정**: 교회별 맞춤 직분 관리
- **계층 구조**: 직분별 권한 및 순서 관리
- **일괄 적용**: 여러 교인에게 직분 일괄 설정

### 4.3 헌금 관리 시스템

#### 4.3.1 헌금 등록
- **교인 헌금**: 교인 선택을 통한 헌금 등록
- **비교인 헌금**: 방문자 및 비교인 헌금 처리
- **헌금 종류**: 주일헌금, 감사헌금, 십일조 등 분류
- **헌금 방법**: 현금, 온라인 등 결제 수단 구분

#### 4.3.2 헌금 내역 관리
- **조회**: 날짜, 종류, 교인별 헌금 내역 조회
- **수정**: 등록된 헌금 정보 수정
- **삭제**: 안전한 헌금 내역 삭제
- **통계**: 실시간 헌금 통계 및 집계

#### 4.3.3 헌금 종류 관리
- **종류 설정**: 교회별 맞춤 헌금 종류 관리
- **우선순위**: 헌금 종류별 표시 순서 설정
- **활성화**: 헌금 종류 활성화/비활성화 관리

### 4.4 모바일 헌금 등록

#### 4.4.1 플로팅 메뉴
- **빠른 접근**: 메인 화면에서 원터치 헌금 등록
- **단계별 진행**: 4단계 간편 등록 프로세스
- **직관적 UI**: 터치 친화적 인터페이스

#### 4.4.2 단계별 등록 프로세스
1. **헌금 종류 선택**: 그리드 방식의 종류 선택
2. **헌금자 선택**: 교인 검색 또는 비교인 이름 입력
3. **헌금 정보 입력**: 금액, 방법, 날짜, 메모 입력
4. **최종 확인**: 입력 정보 검토 및 등록

### 4.5 보고서 시스템

#### 4.5.1 기부금 영수증
- **자동 생성**: 연도별 개인 기부금 영수증 자동 생성
- **PDF 출력**: 정식 영수증 형태의 PDF 생성
- **일괄 처리**: 전체 교인 영수증 일괄 생성
- **맞춤 설정**: 교회 로고 및 정보 포함

#### 4.5.2 월별/연간 보고서
- **월별 집계**: 월별 헌금 현황 및 통계
- **연간 분석**: 연간 헌금 추이 및 비교 분석
- **주차별 상세**: 월별 보고서 내 주차별 세부 분석
- **비교 분석**: 전년 동기 대비 증감률 분석

#### 4.5.3 교인별 상세 보고서
- **개인 분석**: 교인별 헌금 패턴 및 통계
- **헌금 이력**: 개인별 전체 헌금 이력 조회
- **트렌드 분석**: 월별 헌금 추이 및 패턴 분석
- **비교 분석**: 전년 대비 개인 헌금 변화

#### 4.5.4 헌금 종류별 분석
- **종류별 집계**: 헌금 종류별 총액 및 비율
- **순위**: 헌금 종류별 규모 순위
- **추이 분석**: 종류별 월간/연간 추이

### 4.6 대시보드 및 통계

#### 4.6.1 실시간 대시보드
- **금일 현황**: 당일 헌금 현황 실시간 표시
- **월간 현황**: 이번 달 헌금 진행 상황
- **주요 지표**: KPI 및 핵심 통계 표시
- **빠른 작업**: 주요 기능 바로가기

#### 4.6.2 통계 분석
- **시각적 차트**: 다양한 차트를 통한 데이터 시각화
- **트렌드 분석**: 시간별 헌금 추이 분석
- **비교 분석**: 기간별, 종류별 비교 분석
- **예측 분석**: 과거 데이터 기반 추세 예측

## 🎨 사용자 인터페이스 요구사항

### 5.1 반응형 디자인
- **모바일 우선**: 모바일 화면 최적화 우선 설계
- **태블릿 지원**: 태블릿 화면에 최적화된 레이아웃
- **데스크톱 지원**: 큰 화면에서의 효율적 공간 활용
- **크로스 브라우저**: 모든 주요 브라우저 완벽 지원

### 5.2 사용자 경험 (UX)
- **직관적 네비게이션**: 논리적이고 일관된 메뉴 구조
- **빠른 로딩**: 2초 이내 페이지 로딩 시간
- **즉시 피드백**: 사용자 액션에 대한 즉각적 반응
- **에러 처리**: 친화적이고 이해하기 쉬운 에러 메시지

### 5.3 접근성
- **키보드 내비게이션**: 키보드만으로 전체 기능 접근 가능
- **스크린 리더**: 시각 장애인을 위한 스크린 리더 지원
- **색상 대비**: WCAG 2.1 AA 수준의 색상 대비 준수
- **텍스트 크기**: 가변적 텍스트 크기 지원

### 5.4 다크모드 대응
- **텍스트 가독성**: 다크모드에서 명확한 텍스트 시인성
- **색상 일관성**: 라이트/다크 모드 간 일관된 디자인
- **자동 감지**: 시스템 설정에 따른 자동 모드 전환
- **수동 전환**: 사용자 선택에 의한 모드 변경

## 📱 모바일 최적화 요구사항

### 6.1 터치 인터페이스
- **터치 타겟**: 최소 44px 이상의 터치 영역 확보
- **제스처 지원**: 스와이프, 탭 등 기본 제스처 지원
- **터치 피드백**: 터치 시 시각적/햅틱 피드백 제공

### 6.2 성능 최적화
- **번들 크기**: 최적화된 JavaScript 번들 크기
- **이미지 최적화**: WebP 등 최신 이미지 포맷 활용
- **캐싱**: 효율적인 브라우저 캐싱 전략
- **오프라인 지원**: PWA 기능을 통한 기본 오프라인 지원

### 6.3 모바일 전용 기능
- **플로팅 액션 버튼**: 빠른 헌금 등록을 위한 FAB
- **스와이프 네비게이션**: 화면 간 자연스러운 이동
- **풀스크린 모드**: 몰입형 사용자 경험 제공

## 🔒 보안 요구사항

### 7.1 데이터 보안
- **암호화**: 민감 정보 암호화 저장
- **접근 제어**: 역할 기반 접근 제어 (RBAC)
- **감사 로그**: 모든 중요 작업에 대한 로그 기록
- **데이터 백업**: 정기적 자동 백업 및 복구 시스템

### 7.2 애플리케이션 보안
- **SQL 인젝션 방지**: Prepared Statement 사용
- **XSS 방지**: 입력 데이터 검증 및 이스케이프
- **CSRF 방지**: 토큰 기반 CSRF 보호
- **세션 보안**: 안전한 세션 관리 및 만료 처리

### 7.3 프라이버시 보호
- **개인정보 최소화**: 필요 최소한의 개인정보만 수집
- **동의 관리**: 개인정보 처리 동의 관리
- **데이터 삭제**: 요청 시 개인정보 완전 삭제
- **접근 기록**: 개인정보 접근 이력 관리

## 📈 성능 요구사항

### 8.1 응답 시간
- **페이지 로딩**: 초기 페이지 로딩 2초 이내
- **API 응답**: 데이터 조회 API 500ms 이내
- **검색 결과**: 실시간 검색 결과 100ms 이내
- **파일 다운로드**: 보고서 생성 및 다운로드 5초 이내

### 8.2 동시 사용자
- **기본 지원**: 100명 동시 사용자 안정적 지원
- **확장 가능**: 필요시 1,000명까지 확장 가능
- **부하 분산**: 클라우드 기반 자동 확장

### 8.3 데이터 처리
- **대용량 데이터**: 10만 건 이상 헌금 데이터 처리
- **복잡 쿼리**: 다중 조건 검색 및 집계 최적화
- **실시간 업데이트**: 데이터 변경 시 실시간 반영

## 🧪 테스트 요구사항

### 9.1 기능 테스트
- **단위 테스트**: 핵심 비즈니스 로직 80% 이상 커버리지
- **통합 테스트**: API 엔드포인트 전체 테스트
- **E2E 테스트**: 주요 사용자 시나리오 자동화 테스트
- **회귀 테스트**: 신규 기능 추가 시 기존 기능 영향 검증

### 9.2 성능 테스트
- **부하 테스트**: 예상 사용자 수 대비 성능 검증
- **스트레스 테스트**: 시스템 한계점 확인
- **볼륨 테스트**: 대용량 데이터 처리 성능 검증

### 9.3 보안 테스트
- **취약점 스캔**: 자동화된 보안 취약점 검사
- **침투 테스트**: 실제 공격 시나리오 기반 보안 검증
- **데이터 무결성**: 데이터 변조 방지 검증

## 📚 문서화 요구사항

### 10.1 기술 문서
- **API 문서**: 모든 API 엔드포인트 상세 문서
- **데이터베이스 스키마**: ERD 및 테이블 명세서
- **배포 가이드**: 설치 및 배포 절차 상세 가이드
- **설정 가이드**: 시스템 설정 및 커스터마이징 가이드

### 10.2 사용자 문서
- **사용자 매뉴얼**: 기능별 상세 사용법 가이드
- **관리자 가이드**: 시스템 관리 및 설정 가이드
- **FAQ**: 자주 묻는 질문 및 해결 방법
- **문제 해결**: 일반적인 문제 및 해결 방법

## 🚀 Phase 2 확장 계획

### 11.1 고급 기능
- **예산 관리**: 교회 예산 계획 및 실행 관리
- **회계 시스템**: 복식부기 기반 전문 회계 시스템
- **급여 관리**: 교역자 및 직원 급여 관리
- **자산 관리**: 교회 자산 및 재고 관리

### 11.2 통합 기능
- **교인 관리 확장**: 출석 관리, 소그룹 관리
- **예배 관리**: 예배 순서, 설교 관리
- **시설 관리**: 교회 시설 예약 및 관리
- **외부 연동**: 은행 API, 회계 프로그램 연동

### 11.3 분석 기능
- **AI 분석**: 헌금 패턴 AI 분석 및 예측
- **대시보드 고도화**: 고급 분석 및 인사이트
- **자동 알림**: 이상 패턴 감지 및 자동 알림
- **예측 모델**: 헌금 추이 예측 모델

---

**본 문서는 교회 헌금관리시스템 Phase 1의 완전한 개발 요구사항을 정의하며, 성공적인 시스템 구축을 위한 모든 필수 요소를 포함합니다.**